<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#667eea">
    <meta name="description" content="ICQ Messenger - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-–º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –≤ —Å—Ç–∏–ª–µ ICQ">
    <title>ICQ Messenger PWA</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üí¨</text></svg>">
    <!-- –ò–∫–æ–Ω–∫–∏ –¥–ª—è PWA -->
    <link rel="apple-touch-icon" href="https://img.icons8.com/color/192/000000/speech-bubble.png">
</head>
<body>
    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <!-- –®–∞–ø–∫–∞ –¥–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ -->
<header class="header desktop-header">
    <div class="header-left">
        <h1>üí¨ ICQ Messenger</h1>
        <button id="install-btn" class="install-btn" style="display:none;">üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
    </div>
    <div id="user-info" style="display: none;">
        <div class="user-info-left">
            <span id="user-uin" class="user-uin">UIN: ---</span>
            <span id="user-display-name" class="user-display-name"></span>
            <button id="edit-name-btn" class="edit-name-btn" onclick="showEditNameModal()">‚úé</button>
            <span id="user-email" class="user-email"></span>
            <span id="user-status" class="user-status status-offline"></span>
        </div>
        <div class="user-info-right">
            <select id="status-select" class="status-select" onchange="changeStatus(this.value)">
                <option value="online">üü¢ –û–Ω–ª–∞–π–Ω</option>
                <option value="away">üü° –û—Ç–æ—à—ë–ª</option>
                <option value="dnd">üî¥ –ù–µ –±–µ—Å–ø–æ–∫–æ–∏—Ç—å</option>
                <option value="invisible">‚ö´ –ù–µ–≤–∏–¥–∏–º–∫–∞</option>
                <option value="offline">‚ö™ –û—Ñ—Ñ–ª–∞–π–Ω</option>
            </select>
            <button id="logout-btn" class="logout-btn">–í—ã–π—Ç–∏</button>
        </div>
    </div>
</header>

<!-- –®–∞–ø–∫–∞ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ -->
<header class="header mobile-header" style="display: none;">
    <button id="menu-toggle" class="menu-toggle">
        <span class="menu-icon">‚ò∞</span>
        <span class="close-icon" style="display:none;">‚úï</span>
    </button>
    
    <div class="mobile-header-center">
        <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –∏–º—è –∫–æ–Ω—Ç–∞–∫—Ç–∞ -->
        <h1 id="mobile-title">üí¨ ICQ Messenger</h1>
        <div id="mobile-contact-info" style="display:none;">
            <div class="mobile-contact-avatar" id="mobile-chat-avatar"></div>
            <div class="mobile-contact-text">
                <div class="mobile-contact-name" id="mobile-chat-title"></div>
                <div class="mobile-contact-status" id="mobile-chat-status"></div>
            </div>
        </div>
    </div>
    
    <div class="mobile-header-right">
        <button id="mobile-install-btn" class="install-btn" style="display:none;">üì±</button>
    </div>
</header>

<!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö) -->
<!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö) -->
<div class="mobile-sidebar">
    <!-- –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –¢–ï–ö–£–©–ï–ú –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï -->
    <div class="mobile-user-info">
        <div class="mobile-user-top">
            <div class="mobile-user-avatar">
                <span id="mobile-user-avatar-text">?</span>
            </div>
            <div class="mobile-user-details">
                <div class="mobile-user-name" id="mobile-user-name">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                <div class="mobile-user-uin" id="mobile-user-uin">UIN: ---</div>
                <div class="mobile-user-status" id="mobile-user-status">‚ö™ –û—Ñ—Ñ–ª–∞–π–Ω</div>
            </div>
        </div>
        
        <div class="mobile-user-bottom">
            <!-- –í–´–ë–û–† –°–¢–ê–¢–£–°–ê -->
            <select id="mobile-status-select" class="mobile-status-select" onchange="changeMobileStatus(this.value)">
                <option value="online">üü¢ –û–Ω–ª–∞–π–Ω</option>
                <option value="away">üü° –û—Ç–æ—à—ë–ª</option>
                <option value="dnd">üî¥ –ù–µ –±–µ—Å–ø–æ–∫–æ–∏—Ç—å</option>
                <option value="invisible">‚ö´ –ù–µ–≤–∏–¥–∏–º–∫–∞</option>
                <option value="offline">‚ö™ –û—Ñ—Ñ–ª–∞–π–Ω</option>
            </select>
            
            <!-- –ö–ù–û–ü–ö–ò -->
            <div class="mobile-user-buttons">
                <button class="mobile-user-btn" onclick="showEditNameModal()" title="–ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è">‚úé</button>
                <button class="mobile-user-btn logout" onclick="logout()" title="–í—ã–π—Ç–∏">üö™</button>
            </div>
        </div>
    </div>
    
    <!-- –°–ê–ú–û –ú–ï–ù–Æ –° –ö–û–ù–¢–ê–ö–¢–ê–ú–ò -->
    <div class="mobile-sidebar-header">
        <h3>üìá –ú–æ–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã</h3>
        <button class="add-contact-btn" onclick="showAddContact()">
            <span>+</span> –î–æ–±–∞–≤–∏—Ç—å
        </button>
    </div>
    <div class="contacts-search">
        <input type="text" id="mobile-contacts-search" placeholder="–ü–æ–∏—Å–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤..." onkeyup="searchMobileContacts()">
    </div>
    <div id="mobile-contacts-list" class="contacts-list">
        <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        <div class="no-contacts">
            <div>üëã –ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ!</div>
            <p>–î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ UIN</p>
            <button onclick="showAddContact()" class="add-first-contact">–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç</button>
        </div>
    </div>
</div>

<!-- –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ –∫–æ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç—ã –∫–æ–Ω—Ç–∞–∫—Ç—ã -->
<div class="sidebar-overlay" onclick="hideMobileMenu()"></div>
        
        <!-- –≠–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
        <div id="auth-screen" class="screen">
            <div class="auth-container">
                <h2>üí¨ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
                <p class="auth-subtitle">ICQ Messenger - –æ–±—â–∞–π—Ç–µ—Å—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ –∏ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π</p>
                
                <div class="tabs">
                    <button class="tab active" id="login-tab">–í—Ö–æ–¥</button>
                    <button class="tab" id="register-tab">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>
                
                <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
                <div id="login-form" class="form">
                    <div class="form-group">
                        <input type="email" id="login-email" placeholder="Email" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="login-password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                    </div>
                    <button class="auth-btn" onclick="login()">–í–æ–π—Ç–∏</button>
                    <p id="login-error" class="error"></p>
                </div>
                
                <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
                <div id="register-form" class="form" style="display: none;">
                    <div class="form-group">
                        <input type="email" id="reg-email" placeholder="Email" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="reg-password" placeholder="–ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)" required>
                    </div>
                    <div class="form-group">
                        <input type="text" id="reg-display-name" placeholder="–í–∞—à–µ –∏–º—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
                    </div>
                    <button class="auth-btn" onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                    <p id="register-error" class="error"></p>
                </div>
                
                <div class="auth-features">
                    <div class="feature">
                        <span>üîí</span> –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
                    </div>
                    <div class="feature">
                        <span>‚ö°</span> –ë—ã—Å—Ç—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                    </div>
                    <div class="feature">
                        <span>üì±</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω (–±—É–¥–µ—Ç —Å–∫—Ä—ã—Ç –¥–æ –≤—Ö–æ–¥–∞) -->
        <div id="main-screen" class="screen" style="display: none;">
            <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ -->
            <div class="sidebar">
                <div class="sidebar-header">
                    <h3>üìá –ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                    <button class="add-contact-btn" onclick="showAddContact()">
                        <span>+</span> –î–æ–±–∞–≤–∏—Ç—å
                    </button>
                </div>
                <div class="contacts-search">
                    <input type="text" id="contacts-search" placeholder="–ü–æ–∏—Å–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤..." onkeyup="searchContacts()">
                </div>
                <div id="contacts-list" class="contacts-list">
                    <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    <div class="no-contacts">
                        <div>üëã –ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ!</div>
                        <p>–î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ UIN, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∫—É</p>
                        <button onclick="showAddContact()" class="add-first-contact">–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç</button>
                    </div>
                </div>
            </div>
            
<!-- –û–±–ª–∞—Å—Ç—å —á–∞—Ç–∞ -->
<div class="chat-area">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —á–∞—Ç–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
 <div class="chat-header mobile-header">
        <button id="menu-toggle" class="menu-toggle">
            <span class="menu-icon">‚ò∞</span>
            <span class="close-icon" style="display:none;">‚úï</span>
        </button>  -->
        <div id="chat-header-content" class="chat-header-content">
            <div class="chat-contact-info">
                <div class="chat-contact-avatar" id="chat-avatar" style="display:none;"></div>
                <div class="chat-contact-text">
                    <h3 id="chat-title">üí¨ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h3>
                    <div class="chat-contact-details" id="chat-details" style="display:none;">
                        <span class="chat-contact-uin" id="chat-uin">UIN: ---</span>
                        <span class="chat-contact-status" id="chat-status"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>  
    
    <div id="messages-container" class="messages-container">
        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        <div class="welcome-message" id="welcome-message">
            <div class="welcome-icon">üí¨</div>
            <h3>ICQ Messenger</h3>
            <p>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ ‚ò∞ –≤–≤–µ—Ä—Ö—É —Å–ª–µ–≤–∞, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã</p>
            <div class="tips">
                <div class="tip">üí° <strong>–°–æ–≤–µ—Ç:</strong> –°–≤–∞–π–ø–Ω–∏—Ç–µ —Å–ø—Ä–∞–≤–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤</div>
                <div class="tip">üì± <strong>–°–æ–≤–µ—Ç:</strong> –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞</div>
            </div>
        </div>
    </div>
    <div class="message-input-container">
        <input type="text" id="message-input" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç –¥–ª—è –æ–±—â–µ–Ω–∏—è..." disabled>
        <button id="send-btn" class="send-btn" disabled>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </div>
</div>

<!-- –ü–æ–ø–∞–ø –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞ -->
<div id="add-contact-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>üë§ –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç</h3>
            <button class="close-modal" onclick="hideModal()">√ó</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="uin-input">UIN –∏–ª–∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                <input type="text" id="uin-input" placeholder="–í–≤–µ–¥–∏—Ç–µ 9-–∑–Ω–∞—á–Ω—ã–π UIN –∏–ª–∏ –∏–º—è">
                <p class="hint">üí° –ú–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ 9-–∑–Ω–∞—á–Ω—ã–π UIN (–Ω–∞–ø—Ä–∏–º–µ—Ä: 123456789) –∏–ª–∏ —á–∞—Å—Ç—å –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
                <p class="hint">üìç –í–∞—à UIN: <span id="my-uin">---</span> (–ø–æ–∫–∞–∂–∏—Ç–µ –¥—Ä—É–∑—å—è–º)</p>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="addContact()">–ù–∞–π—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å</button>
                <button class="btn-secondary" onclick="hideModal()">–û—Ç–º–µ–Ω–∞</button>
                <p id="add-contact-error" class="error"></p>
                <p id="add-contact-message"></p>
            </div>
        </div>
    </div>
</div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Supabase -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <!-- –ù–∞—à JavaScript -->
    <script src="app.js"></script>
    
    <script>
        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
        function searchContacts() {
            const searchTerm = document.getElementById('contacts-search').value.toLowerCase();
            const contacts = document.querySelectorAll('.contact-item');
            
            contacts.forEach(contact => {
                const contactName = contact.querySelector('.contact-name').textContent.toLowerCase();
                const contactUin = contact.querySelector('.contact-uin').textContent.toLowerCase();
                
                if (contactName.includes(searchTerm) || contactUin.includes(searchTerm)) {
                    contact.style.display = 'flex';
                } else {
                    contact.style.display = 'none';
                }
            });
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º UIN –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
        document.addEventListener('DOMContentLoaded', () => {
            // –≠—Ç–æ—Ç –∫–æ–¥ –æ–±–Ω–æ–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è
            setTimeout(() => {
                const uinElement = document.getElementById('user-uin');
                if (uinElement) {
                    const myUin = document.getElementById('my-uin');
                    myUin.textContent = uinElement.textContent.replace('UIN: ', '');
                }
            }, 1000);
        });
    </script>
<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–º–µ–Ω–∏ -->
<div id="edit-name-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è</h3>
            <button class="close-modal" onclick="hideEditNameModal()">√ó</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="new-display-name">–í–∞—à–µ –∏–º—è:</label>
                <input type="text" id="new-display-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" maxlength="30">
                <p class="hint">üí° –≠—Ç–æ –∏–º—è –±—É–¥—É—Ç –≤–∏–¥–µ—Ç—å –¥—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</p>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="saveDisplayName()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="btn-secondary" onclick="hideEditNameModal()">–û—Ç–º–µ–Ω–∞</button>
                <p id="edit-name-error" class="error"></p>
                <p id="edit-name-message"></p>
            </div>
        </div>
    </div>
</div>
    </div>
</body>
</html>
