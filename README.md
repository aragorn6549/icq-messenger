# ICQ Messenger - –í–µ–±-–º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä PWA

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-–º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –≤ —Å—Ç–∏–ª–µ ICQ, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∫–∞–∫ Progressive Web App —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Supabase.

## üåü –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚úÖ **PWA** - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–∫ –Ω–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- ‚úÖ **Real-time —á–∞—Ç** - –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤** - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ UIN
- ‚úÖ **–°—Ç–∞—Ç—É—Å—ã –æ–Ω–ª–∞–π–Ω** - 5 —Å—Ç–∞—Ç—É—Å–æ–≤ (–æ–Ω–ª–∞–π–Ω, –æ—Ç–æ—à–µ–ª, –∏ —Ç.–¥.)
- ‚úÖ **Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
- ‚úÖ **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ –ø–æ email
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω** - –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- ‚úÖ **–û—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º** - –†–∞–±–æ—Ç–∞ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- ‚úÖ **–¢–µ–º–Ω–∞—è —Ç–µ–º–∞** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase

1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ [Supabase](https://supabase.com)
2. –í–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ email –≤ —Ä–∞–∑–¥–µ–ª–µ Authentication
3. –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑ SQL –Ω–∏–∂–µ
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á–∏ –ø—Ä–æ–µ–∫—Ç–∞:
   - `Project URL` ‚Üí `SUPABASE_URL`
   - `anon public` ‚Üí `SUPABASE_ANON_KEY`

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

```sql
-- –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
create table profiles (
  id uuid references auth.users on delete cascade primary key,
  uin bigint unique not null,
  display_name text,
  status text default 'online',
  last_seen timestamptz default now()
);

-- –ö–æ–Ω—Ç–∞–∫—Ç—ã
create table contacts (
  id bigint generated by default as identity primary key,
  user_id uuid references profiles(id) on delete cascade,
  contact_id uuid references profiles(id) on delete cascade,
  status text default 'pending',
  created_at timestamptz default now(),
  unique(user_id, contact_id)
);

-- –°–æ–æ–±—â–µ–Ω–∏—è
create table messages (
  id bigint generated by default as identity primary key,
  sender_id uuid references profiles(id) on delete cascade,
  receiver_id uuid references profiles(id) on delete cascade,
  content text,
  created_at timestamptz default now()
);

-- –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ (ROW Level Security)
alter table profiles enable row level security;
alter table contacts enable row level security;
alter table messages enable row level security;

-- –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è profiles
create policy "Users can view all profiles"
  on profiles for select
  using (true);

create policy "Users can update own profile"
  on profiles for update
  using (auth.uid() = id);

-- –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è contacts
create policy "Users can view their contacts"
  on contacts for select
  using (auth.uid() = user_id or auth.uid() = contact_id);

create policy "Users can insert their contacts"
  on contacts for insert
  with check (auth.uid() = user_id);

create policy "Users can update their contacts"
  on contacts for update
  using (auth.uid() = user_id);

-- –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è messages
create policy "Users can view their messages"
  on messages for select
  using (auth.uid() = sender_id or auth.uid() = receiver_id);

create policy "Users can insert their messages"
  on messages for insert
  with check (auth.uid() = sender_id);